
R version 2.5.0 (2007-04-23)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ##############################
> ## Datasets of Mikas Vengris, Denitsa Grancharova 
> ## and Rienk van Grondelle 
> ##############################
> 
> ##############################
> ## load TIMP
> ##############################
> 
> require(TIMP)
Loading required package: TIMP
Loading required package: tcltk
Loading Tcl/Tk interface ... done
Loading required package: vcd
Loading required package: MASS
Loading required package: grid
Loading required package: colorspace
Loading required package: fields
fields is loaded use help(fields) for an overview of this library
Loading required package: gplots
Loading required package: gtools
Loading required package: gdata

Attaching package: 'gplots'


	The following object(s) are masked from package:stats :

	 lowess 

Loading required package: splines
[1] TRUE
> 
> ##############################
> ## READ IN PSI 1
> ##############################
> 
> denS4<-readData("psi_1.txt")
Read 1 item
Read 2385 items
> 
> ##############################
> ## PREPROCESS PSI 1
> ##############################
> 
> denS4<-preProcess(data = denS4, scalx2 = c(3.78, 643.5))
> 
> ##############################
> ## READ IN PSI 2
> ##############################
> 
> denS5<-readData("psi_2.txt")
Read 1 item
Read 2385 items
> 
> ##############################
> ## PREPROCESS PSI 2
> ##############################
> 
> denS5<-preProcess(data = denS5, scalx2 = c(3.78, 643.5))
> 
> ##############################
> ## GROUP PSI 1, PSI 2
> ##############################
> 
> dataDEN <- list(denS4, denS5)
> 
> ##############################
> ## DEFINE KINETIC STARTING VALUES
> ##############################
> 
> kinpar = c(7.9, 1.08, 0.129, .0225, .00156) 
> 
> 
> ##############################
> ## REFINE MODEL FURTHER AS NEW MODEL OBJECT 
> ##############################
> 
> model2 <- initModel(mod_type = "kin", 
+ kinpar=kinpar, 
+ irfpar=c( -.1018, 0.0434), 
+ parmu = list(c(.230)), 
+ lambdac = 650,
+ seqmod=TRUE,
+ positivepar=c("kinpar", "coh"), 
+ cohspec = list( type = "seq", start = c(8000, 1800)))
> 
> ##############################
> ## FIT NEW MODEL OBJECT
> ##############################
> 
> denRes<-fitModel(dataDEN, list(model2),
+ modeldiffs = list(dscal = list(list(to=2,from=1,value=.457)), 
+ free = list(
+ list(what = "irfpar", ind = 1, dataset = 2, start=-.1932),
+ list(what = "kinpar", ind = 5, dataset = 2, start=.0004), 
+ list(what = "kinpar", ind = 4, dataset = 2, start= .0159)
+ )),
+ opt=kinopt(iter=5,superimpose = c(1,2), divdrel = TRUE, linrange = .2,
+ makeps = "den3", selectedtraces = c(1,5,10), plotkinspec =TRUE, 
+ paropt=list(cex.main=1.2,cex.lab=1.2,cex.axis=1.2),
+ stderrclp = TRUE, kinspecerr=TRUE, 
+ kinspecest=TRUE, xlab = "time (ps)", ylab = "wavelength", 
+ breakdown = list(plot=c(643.50, 658.62, 677.52), 
+ superimpose=1:2 )))
2.720968 :   8.98719682  7.49554194 -0.10180000  0.04340000  2.06686276  0.07696104 -2.04794287 -3.79423997 -6.46306946  0.23000000 -0.19320000 -7.82404601 -4.14143617  0.45700000 
  It.   1, fac=           1, eval (no.,total): ( 1,  1): new dev = 3.22637
  It.   1, fac=         0.5, eval (no.,total): ( 2,  2): new dev = 3.12687
  It.   1, fac=        0.25, eval (no.,total): ( 3,  3): new dev = 2.72808
  It.   1, fac=       0.125, eval (no.,total): ( 4,  4): new dev = 2.72118
  It.   1, fac=      0.0625, eval (no.,total): ( 5,  5): new dev = 2.72095
2.720953 :   8.04153185  7.58150137 -0.10190332  0.04340082  2.06759094  0.07801666 -2.04493231 -3.79358642 -6.46261919  0.23004699 -0.19329516 -7.81718246 -4.13362230  0.45692718 
  It.   2, fac=       0.125, eval (no.,total): ( 1,  6): new dev = 2.7211
  It.   2, fac=      0.0625, eval (no.,total): ( 2,  7): new dev = 2.72099
  It.   2, fac=     0.03125, eval (no.,total): ( 3,  8): new dev = 2.72096
  It.   2, fac=    0.015625, eval (no.,total): ( 4,  9): new dev = 2.72096
  It.   2, fac=   0.0078125, eval (no.,total): ( 5, 10): new dev = 2.72095
  It.   2, fac=  0.00390625, eval (no.,total): ( 6, 11): new dev = 2.72095
  It.   2, fac=  0.00195312, eval (no.,total): ( 7, 12): new dev = 2.72095
  It.   2, fac= 0.000976562, eval (no.,total): ( 8, 13): new dev = 2.72095
Warning message:
step factor 0.000488281 reduced below 'minFactor' of 0.000976562 
> 
> 
> 
> 
> 
