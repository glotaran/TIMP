
R version 2.5.0 (2007-04-23)
Copyright (C) 2007 The R Foundation for Statistical Computing
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> C <- matrix(nrow = 51, ncol = 2)
> k <- c(.5, 1)
> t <- seq(0, 2, by = 2/50) 
> C[, 1] <- exp( - k[1] * t) 
> C[, 2] <- exp( - k[2] * t) 
> 
> E <- matrix(nrow = 51, ncol = 2)
> wavenum <- seq(18000,28000, by=200)
> location <- c(25000, 20000) 
> delta <- c(5000, 7000)
> amp <- c(1, 2)  
> E[, 1] <- amp[1] * exp( - log(2) * (2 * (wavenum - location[1])/delta[1])^2)
> E[, 2] <- amp[2] * exp( - log(2) * (2 * (wavenum - location[2])/delta[2])^2)
> 
> sigma <- .001
> Psi_q  <- C %*% t(E) + sigma * rnorm(dim(C)[1] * dim(E)[1])
> 
> require(TIMP) 
Loading required package: TIMP
Loading required package: tcltk
Loading Tcl/Tk interface ... done
Loading required package: vcd
Loading required package: MASS
Loading required package: grid
Loading required package: colorspace
Loading required package: fields
fields is loaded use help(fields) for an overview of this library
Loading required package: gplots
Loading required package: gtools
Loading required package: gdata

Attaching package: 'gplots'


	The following object(s) are masked from package:stats :

	 lowess 

Loading required package: splines
[1] TRUE
> 
> Psi_q_data <- dat(psi.df = Psi_q, x = t, nt = length(t), x2 = wavenum, nl =
+ length(wavenum)) 
> 
> kinetic_model <- initModel(mod_type = "kin", seqmod = FALSE, 
+ kinpar = c(.1, 2)) 
> 
> gc(verbose=TRUE) 
Garbage collection 40 = 32+4+4 (level 2) ... 
9.7 Mbytes of cons cells used (68%)
1.3 Mbytes of vectors used (21%)
         used (Mb) gc trigger (Mb) max used (Mb)
Ncells 362937  9.7     531268 14.2   467875 12.5
Vcells 162836  1.3     786432  6.0   395496  3.1
> kinetic_fit <- fitModel(data = list(Psi_q_data), 
+ modspec = list(kinetic_model), opt = kinopt(iter=4, plot=FALSE))
16.52863 :  0.1 2.0 
  It.   1, fac=           1, eval (no.,total): ( 1,  1): new dev = 0.54132
0.5413204 :  0.3635882 1.2340099 
  It.   2, fac=           1, eval (no.,total): ( 1,  2): new dev = 0.0131987
0.0131987 :  0.4652259 1.0338661 
  It.   3, fac=           1, eval (no.,total): ( 1,  3): new dev = 0.0024941
0.002494101 :  0.4977081 1.0019435 
  It.   4, fac=           1, eval (no.,total): ( 1,  4): new dev = 0.00246075
0.002460754 :  0.4997508 0.9999449 
Warning message:
number of iterations exceeded maximum of 4 
> gc(verbose=TRUE) 
Garbage collection 54 = 44+5+5 (level 2) ... 
10.2 Mbytes of cons cells used (63%)
1.8 Mbytes of vectors used (29%)
         used (Mb) gc trigger (Mb) max used (Mb)
Ncells 378346 10.2     597831   16   531268 14.2
Vcells 224726  1.8     786432    6   786431  6.0
> 
> 
